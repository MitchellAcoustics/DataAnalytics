---
title: "Visualisation"
output: learnr::tutorial
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
library(learnr)
library(ggplot2)
library(dplyr)
knitr::opts_chunk$set(echo = FALSE)
```


## Introduction

Looking at our data is a fundamental first step when starting any analysis. To do this we will create plots. In this tutorial, we will learn how to create plots using the package `ggplot2`.
We will use the data on the British Social Attitudes Survey (BSA) that we used in the previous tutorial and recreate the following plot:


```{r plotex, message=FALSE, warning=FALSE}
bsa <- readRDS("./data/bsa2021_healthcare_equalities_recoded.rds")

bsa <- bsa |> mutate(welfare2 = if_else(welfare2 == 9, NA, welfare2),
                     leftrigh = if_else(leftrigh == 9, NA, leftrigh))
ggplot(data = bsa, aes(x=leftrigh, y=welfare2)) + 
  geom_point(aes(shape = DVSex21), alpha=0.05) +
  geom_smooth(method = "loess", se = FALSE) +
  labs(title = "Welfare perception by political orientation",
       x = "Political orientation\n(1 = left, 5 = right)",
       y = "Welfare perception\n(1 = sympathetic, 5 = poor don't deserve)") +
  guides(shape = guide_legend(title = "Sex"))
```

We will start by loading the data and then create a simple plot using the package `ggplot2`, then we will start on the main task of this tutorial: recreating the plot above.


### Loading the BSA data

Remember the British Social Attitudes data from the previous tutorial? We will work with this data in this tutorial, so let's start by loading it.
The data to load is the RDS version of this data

Write the R code required:

```{r loaddta, exercise=TRUE}
bsa <- ____
```

```{r loaddta-solution}
bsa <- readRDS("./data/bsa2021_healthcare_equalities_recoded.rds")
```

## Your very first plot!

With this data loaded, we will create our very first plot using the package `ggplot2`.


```{r ggplot1, exercise=TRUE, exercise.setup="loaddta-solution"}
library(ggplot2)

ggplot(data = bsa, aes(x=leftrigh, y=welfare2)) + 
  geom_point()


```

## ggplot

### What is in a layer?

## Building the example plot

```{r print-limit, exercise=TRUE}

```


